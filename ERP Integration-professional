## Apps for my business
This series of API Recipes describes API tasks associated with Apps for my business. Apps for my business are applications designed for financial integration companies and finance leaders who want to track their employees travel and entertainment expenses in order to increase compliance with spending guidelines, control unnecessary spend and reduce costs and risk. This API Recipe explains the process for obtaining client expense report data from Concur through Enterprise Resource Planning (ERP) integration

Before a partner user can obtain expense report data from Concur, ensure that you have completed the following:

- Ensure your app has been certified by Concur
- Ensure your organization has obtained a signed letter of Agreement from a client stating that you can obtain that client’s expense report data using the extract file created by Concur’s service.
- Ensure your app supports Concur’s App Center flow.
- Ensure your app can authenticate with Concur using either [Native Flow](https://developer.concur.com/api-reference/authentication/authentication.html#native) (preferred) or Web Flow
- Ensure your app includes the ability to refresh the Concur authentication token <API Guide link>
- Ensure your app includes the ability to respond appropriately to revoked token messages <API Guide link>

#### Apps for my business: Professional Edition ERP Integration
Professional Edition ERP Integration assumes that you are working for or on behalf of a Financial Integration Company. As such, the client we support in common may have elected to include additional functionality resulting in more complex journal entries. For example, your client may allow cash advances or personal funds amounts which are part of a company paid corporate credit transaction. These types of additional financial option require more care when pulling the extract file from Concur. You should consult with the client to determine if they include these types of offerings.

The sample case below provides insight into these more complex entries:
##### Cash Advance Transaction
```
<html>
<body>


<img src="/images/Cash_advance" alt="Cash Advance" width="1229" height="704">

</body>
</html>
```
Get Extract Files for your client

Use the following process and their associated API to obtain extract files for your client from Concur:

Navigate to [Extracts](https://developer.concur.com/api-reference/common/extracts/extracts.html).
Obtain a list extract definitions for your client. Keep in mind that the authorization header with the OAuth token must be for a valid user. The OAuth consumer must have one the following roles in Concur: Company Administrator or Web services Administrator for Professional ERP Integration.

Your GET request looks like the example
```
xml
    GET https://www.concursolutions.com/api/expense/extract/v1.0/ HTTP/1.1
    Authorization: OAuth {access token}
    ...
    ```
XML example of a successful response:
```
xml
    200 OK
    Content-Type: application/xml

    <definitions xmlns="http://www.concursolutions.com/api/expense/extract/2010/02">
        <definition>
            <id>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd</id>
            <job-link>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job</job-link>
            <name>Standard Accounting Extract</name>
        </definition>
        <definition>
            <id>https://www.concursolutions.com/api/expense/extract/v1.0/Umj$swS19lpd7Sk$phUYl67wE1ss4Q$shu</id>
            <job-link>https://www.concursolutions.com/api/expense/extract/v1.0/Umj$swS19lpd7Sk$phUYl67wE1ss4Q$shu</job-link>
            <name>European Extract</name>
        </definition>
        <definition>
            <id>https://www.concursolutions.com/api/expense/extract/v1.0/8LjhN23Hs33$piUUfy4ytTqa$sqqacYeP1</id>
            <job-link>https://www.concursolutions.com/api/expense/extract/v1.0/8LjhN23Hs33$piUUfy4ytTqa$sqqacYeP1</job-link>
            <name>Asian Extract</name>
        </definition>
    </definitions>
```
Locate the desired definitions for your client. You may need to obtain additional details as there may be multiple files to obtain depending on client requirements. You should record the Definition ID to use in subsequent APIs because doing so eliminates a common step. Your GET extract definitions details request looks like the example:
```

xml
    GET https://www.concursolutions.com/api/expense/extract/v1.0/{DefinitionID} HTTP/1.1
    Authorization: OAuth {access token}
    ...
    ```
XML example of a successful response:
```
xml
    200 OK
    Content-Type: application/xml

     <definition xmlns="http://www.concursolutions.com/api/expense/extract/2010/02" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <id>https://www.concursolutions.com/api/expense/extract/v1.0/n59FpBJ8hN3qVWTFIrtxkOT5$pef6DmIj3</id>
        <name>AMEX Remittance - US</name>
        <job-link>https://www.concursolutions.com/api/expense/extract/v1.0/n59FpBJ8hN3qVWTFIrtxkOT5$pef6DmIj3/job</job-link>
    </definition>
    ```

Obtain and record the Job_ID using this GET request: https://www.concursolutions.com/api/expense/extract/v1.0/{DefinitionID}/job. This will request a list of the last 100 extract jobs run for the specified extract definition.

XML example of a Job ID GET request:
```
GET https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job HTTP/1.1
    Authorization: OAuth {access token}
    ...
    ```
XML example of a successful response:
```
200 OK
Content-Type: application/xml

<jobs xmlns="...">
    <job>
        <id>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/uIo87jk3SHudi$sdlYle8$peot$pD21jyd</id>
        <status-link>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/uIo87jk3SHudi$sdlYle8$peot$pD21jyd/status</status-link>
        <start-time>2010-01-13T18:30:02Z</start-time>
        <status>Queued</status>
    </job>
    <job>
        <id>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/21UwwqA3jk25Lis77jF$piiD21c89lLwEq</id>
        <status-link>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/21UwwqA3jk25Lis77jF$piiD21c89lLwEq/status</status-link>
        <start-time>2010-01-13T18:30:02Z</start-time>
        <stop-time>2010-01-13T18:30:50Z</stop-time>
        <status>Complete</status>
        <file-link>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/21UwwqA3jk25Lis77jF$piiD21c89lLwEq/file</file-link>
    </job>
    <job>
        <id>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/uI77ndy0Q1szuU73XSh56lshi$p215gHs1</id>
        <status-link>https://www.concursolutions.com/api/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/uI77ndy0Q1szuU73XSh56lshi$p215gHs1/status</status-link>
        <start-time>2010-01-12T18:30:01Z</start-time>
        <stop-time>2010-01-12T18:31:01Z</stop-time>
        <status>Complete</status>
        <file-link>https://www.concursolutions.com/api/expense/extract/v1.0/nYoPK$pZmcowMRUqcl5bnDAwwsMydyt$xd/job/uI77ndy0Q1szuU73XSh56lshi$p215gHs1/file</file-link>
    </job>
</jobs>
```

GET the status of the Extract File Job using this GET request:
```
GET https://www.concursolutions.com/api/expense/extract/v1.0/{DefinitionID}/job/{JobID}/status HTTP/1.1
    Authorization: OAuth {access token}
    ...
    ```
XML example of a successful response:
```
200 OK
    Content-Type: application/xml
    <job xmlns="http://www.concursolutions.com/api/expense/extract/2010/02" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <id>https://www.concursolutions.com/api/expense/extract/v1.0/nX8O9$pytn6vJEWvLOZxyy3GcNGyj0ZklG/job/nIJp1lR2R0LNT4XcO5fXG$s$sZmVuRTuG$ps</id>
        <status-link>https://www.concursolutions.com/api/expense/extract/v1.0/nX8O9$pytn6vJEWvLOZxyy3GcNGyj0ZklG/job/nIJp1lR2R0LNT4XcO5fXG$s$sZmVuRTuG$ps/status</status-link>
        <start-time>2011-08-25T14:25:22.58</start-time>
        <stop-time>2011-08-25T14:25:23.537</stop-time>
        <status>Completed</status>
        <file-link>https://www.concursolutions.com/api/expense/extract/v1.0/nX8O9$pytn6vJEWvLOZxyy3GcNGyj0ZklG/job/nIJp1lR2R0LNT4XcO5fXG$s$sZmVuRTuG$ps/file</file-link>
    </job>
    ```

GET the desired file using this GET request: 
```
xml
    GET https://www.concursolutions.com/api/expense/extract/v1.0/{DefinitionID}/job/{JobID}/file HTTP/1.1
    Authorization: OAuth {access token}
    ...
    ```
XML example of a successful response for a single extract file:
```
xml
    200 OK
    Content-Type: text/csv
    100,AAA,BBBB,CCCC,...<rest of file>
    ```

XML example of a successful response for multiple extract files:
```
xml
    200 OK
    Content-Type: application/zip
    <zip file contents>
```
#### Make us better at making your experience easier.
Share a Concur API process issue we can do better. Provide us with an explanation, screen shots and your recommendation [here](http://forum.developer.concur.com/).
